@if (processando) {
	<div class="loading">Loading&#8230;</div>
}

<div class="container-fluid" id="contentToConvert">
	<div class="callout callout-pesquisa">
		<div class="row">
		   <div class="col-12">
			  <span class="badge bg-dark fw-bold ">Relatorio ->Financeiro -> Por Atividades:</span>
		   </div>
		</div>
		<div class="row">
		 <div class="col-md-9">
			 <div class="row">
				 <div class="col-md-auto">
					<label class="form-label">Atividade:</label>
					<div class="form-group input-group">
						<select [(ngModel)]="filtro.atividade" type="text" #campoInicial class="form-control form-control-sm form-select-sm" (change)="filtrarAtividade()">
							<option *ngFor="let t of listaAtividadesCurso" [value]="t.id">{{ t.descricao }}</option>
						</select>&nbsp;&nbsp;&nbsp;&nbsp;
						<select [(ngModel)]="filtro.turma " type="text" class="form-control form-control-sm form-select-sm" (change)="filtrarTurma()">
							<option value=""></option>						
							<option *ngFor="let t of listaTipoCategoria" [value]="t.id">{{ t.descricao }}</option>
						</select>
					</div>
				  </div>
  				 <div class="col-md-2" >
					<label class="form-label">Financeiro:</label>
						<select [(ngModel)]="filtro.situacao_financeira " type="text" class="form-control form-control-sm form-select-sm" (change)="filtrarFinanceiro()">
							<option *ngFor="let t of listaSituacaoFinanceira" [value]="t.id">{{ t.descricao }}</option>
						</select>
				 </div>
				 <div class="col-md-3">
						<label class="form-label">			 
						   <div class="form-check">
							   <input class="form-check-input" type="checkbox" value="" #checkBox_filtro_somenteAtivos [checked]="filtro.somenteAtivos == 'S'" (change)="refresh()"/>
							   <label class="form-check-label" for="flexCheckChecked">	Matriculas Ativas	</label>
						   </div>
					   </label><br>
					<!--button type="button" class="btn btn-outline-primary" (click)="openModal(content, '')">Novo</button>&nbsp;&nbsp;&nbsp;&nbsp;-->
					<button type="button" class="btn btn-outline-primary btn-sm" (click)="refresh()"><i class="fa fa-refresh" aria-hidden="true"></i></button>&nbsp;&nbsp;&nbsp;&nbsp;
					<button type="button" class="btn btn-outline-success btn-sm" (click)="exportexcel()"><i class="fa fa-file-excel-o" aria-hidden="true"></i></button>&nbsp;&nbsp;&nbsp;&nbsp;
					<button type="button" class="btn btn-outline-danger btn-sm" (click)="gerarPDF()"><i class="fa fa-file-pdf-o" aria-hidden="true"></i></button>&nbsp;&nbsp;&nbsp;&nbsp;				   
				 </div>
			  </div>
		 </div>
		 <div class="col-md-2 offset-md-1" [hidden]="listaRelOriginal == undefined || listaRelOriginal.length <= 0 ">
			 <div class="row">
				 <div class="col-12">
					<p class="text-end">Total encontrados : <b>{{paginacao.total}}</b></p>
					<input	type="text"	class="form-control form-control-sm" name="searchTerm" #campoPesquisa [(ngModel)]="searchTerm" (ngModelChange)="filtrar()"/>
				 </div>
			  </div>
		 </div>
	   </div>		
	 </div>


	<div class="tabela" >
	   <form>
		  <hr>
		  <table class="table table-striped" id="excel-table">
			 <thead>
				<tr >
				   <th>Nome</th>
				   <th>Tipo</th>
				   <th >Turma</th>
				   <th></th>				   
				</tr>				
			 </thead>
			 <tbody>

				<tr  *ngFor="let l of listaRel" (click)="openModal(l)">
					<td>
						<ngb-highlight class="textoTabela" [result]="l.nome" [term]="searchTerm" />
					</td>	
					<td>
						<ngb-highlight class="textoTabela" [result]="getTipoAluno(l.tp_aluno)" [term]="searchTerm" />
					</td>	
					<td >
						<ngb-highlight class="textoTabela" [result]="l.turma" [term]="searchTerm" />
					</td>	
					<td>
						<div class="row mb-2" *ngFor="let d of l.listaDebitos">
							<div class="col-9">						
								{{getMesAnoLancamento(d.ano_mes)}} - {{d.descricao}}/{{d.categoria}}
							</div>
							<div class="col-3">						
								{{d.valor | currency : 'BRL'}}
							</div>
						</div>
						<hr [hidden]="l.listaDebitos.length <= 0">
						<div class="row mb-2" [hidden]="l.listaDebitos.length <= 0">
							<div class="col-9">						
								<b><i>Valor Total do Débito:</i></b>
							</div>
							<div class="col-3">						
								<b><i>{{l.debitos | currency : 'BRL'}}</i></b>
							</div>
						</div>
					</td>	
				</tr>
			 </tbody>
		  </table>
		  <div class="d-flex justify-content-between p-2">
			 <ngb-pagination [collectionSize]="(paginacao.total)!" [(page)]="paginacao.page" [pageSize]="paginacao.pageSize" (pageChange)="filtrar()">
			 </ngb-pagination>
			 <select class="form-select-sm" style="width: auto" name="pageSize" [(ngModel)]="paginacao.pageSize">
			 <option [ngValue]="100">100 itens por página</option>
			 <option [ngValue]="250">250 itens por página</option>
			 <option [ngValue]="500">500 itens por página</option>
			 </select>
		  </div>
	   </form>
	</div>
